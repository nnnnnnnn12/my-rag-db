<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„ RAG åŠ©æ‰‹æœºå™¨äºº</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 50px auto; background: #f4f7f6; }
        #chat-box { height: 400px; border: 1px solid #ddd; background: #fff; overflow-y: auto; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
        .user { text-align: right; color: #2c3e50; margin: 5px 0; }
        .ai { text-align: left; color: #27ae60; margin: 5px 0; background: #e8f5e9; padding: 8px; border-radius: 5px; }
        .input-area { display: flex; gap: 10px; }
        input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <h2>ğŸ¤– RAG çŸ¥è¯†åº“åŠ©æ‰‹</h2>
    <div id="chat-box"></div>
    <div class="input-area">
        <input type="text" id="userInput" placeholder="è¾“å…¥å…³é”®è¯ï¼Œå¦‚ï¼šæ°”æ¸©...">
        <button onclick="sendMsg()">å‘é€</button>
    </div>

    <script>
        async function sendMsg() {
            const input = document.getElementById('userInput');
            const chatBox = document.getElementById('chat-box');
            if (!input.value) return;

            // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
            chatBox.innerHTML += `<div class="user">æˆ‘: ${input.value}</div>`;
            
            try {
                // è¯·æ±‚ä½ çš„ Go åç«¯æ¥å£
                const response = await fetch(`http://localhost:8080/chat?q=${encodeURIComponent(input.value)}`);
                const data = await response.json();
                
                // æ˜¾ç¤º AI å›ç­”åŠæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡
                chatBox.innerHTML += `<div class="ai">
                    <b>AI:</b> ${data.ai_reply}<br>
                    <small style="color:#999">æ£€ç´¢ä¾æ®: ${data.context || 'æ— '}</small>
                </div>`;
            } catch (err) {
                chatBox.innerHTML += `<div class="ai" style="color:red">é”™è¯¯: æ— æ³•è¿æ¥åˆ°åç«¯</div>`;
            }
            
            input.value = '';
            chatBox.scrollTop = chatBox.scrollHeight;
        }
    </script>
</body>
</html>